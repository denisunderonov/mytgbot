import { Bot, InlineKeyboard } from "grammy";
import * as dotenv from "dotenv";

// –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–∑ —Ñ–∞–π–ª–∞ .env
dotenv.config();

// –ü–æ–ª—É—á–∞–µ–º —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
const token = process.env.BOT_TOKEN;

if (!token) {
  throw new Error("BOT_TOKEN –Ω–µ –Ω–∞–π–¥–µ–Ω! –ü—Ä–æ–≤–µ—Ä—å —Ñ–∞–π–ª .env");
}

// –°–æ–∑–¥–∞—ë–º —ç–∫–∑–µ–º–ø–ª—è—Ä –±–æ—Ç–∞
const bot = new Bot(token);

// –ö–æ–º–∞–Ω–¥–∞ /start - –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —Å –∫–Ω–æ–ø–∫–∞–º–∏
bot.command("start", async (ctx) => {
  // –°–æ–∑–¥–∞—ë–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–Ω–æ–ø–∫–∞–º–∏
  const keyboard = new InlineKeyboard()
    .text("–ü—Ä–æ–µ–∫—Ç—ã", "projects")    // —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏, callback_data
    .text("–õ–∏—á–Ω—ã–π –¢–ì–ö", "blog");          // .text() –¥–æ–±–∞–≤–ª—è–µ—Ç –∫–Ω–æ–ø–∫—É –≤ —Ç–µ–∫—É—â–∏–π —Ä—è–¥
    // .row() - –Ω–∞—á–∞—Ç—å –Ω–æ–≤—ã–π —Ä—è–¥ –∫–Ω–æ–ø–æ–∫ (–ø–æ–∫–∞ –Ω–µ –Ω—É–∂–Ω–æ)

  // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–∞–º–∏
  await ctx.reply(
    "üëã –ü—Ä–∏–≤–µ—Ç! –Ø —Ç—É—Ç –Ω–µ–º–Ω–æ–≥–æ –≤ full-stack –ø—ã—Ç–∞—é—Å—å.\n\n" +
    "–í–æ—Ç –ø—Ä–∏–º–µ—Ä—ã –º–æ–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤. –í—ã–±–µ—Ä–∏ —Ä–∞–∑–¥–µ–ª:",
    {
      reply_markup: keyboard,  // –¥–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –∫ —Å–æ–æ–±—â–µ–Ω–∏—é
    }
  );
});
// ============================================
// –û–ë–†–ê–ë–û–¢–ö–ê –ù–ê–ñ–ê–¢–ò–ô –ù–ê –ö–ù–û–ü–ö–ò
// ============================================

// –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É "–ü—Ä–æ–µ–∫—Ç—ã"
bot.callbackQuery("projects", async (ctx) => {
  // –£–±–∏—Ä–∞–µ–º "—á–∞—Å–∏–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏" –Ω–∞ –∫–Ω–æ–ø–∫–µ
  await ctx.answerCallbackQuery();
  
  // –ò–∑–º–µ–Ω—è–µ–º —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è (—Ç–æ –∂–µ —Å–∞–º–æ–µ —á—Ç–æ –±—ã–ª–æ –≤ /projects)
  await ctx.editMessageText(
    "üöÄ –ú–æ–∏ –ø—Ä–æ–µ–∫—Ç—ã:\n\n"
  );
});

// –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É "–ë–ª–æ–≥"
bot.callbackQuery("blog", async (ctx) => {
  await ctx.answerCallbackQuery();
  
  await ctx.editMessageText(
    "denisunderonov.webp\n\n" +
    "t.me/igotcold"
  );
});
// –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
bot.start({
  onStart: (botInfo) => { // botInfo - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–æ—Ç–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ–≥–æ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è); onStart - —Ñ—É–Ω–∫—Ü–∏—è, –≤—ã–∑—ã–≤–∞–µ–º–∞—è –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞
    console.log(`‚úÖ –ë–æ—Ç @${botInfo.username} –∑–∞–ø—É—â–µ–Ω!`);
  },
});